---
description: |
  [プロジェクト初期化] 仕様書またはアイデアから開発タスクを抽出し、フローを初期化します。既存のフローは上書きされます。
argument_hint: '[仕様書のファイルパス | "実装したい内容の要約"]'
notes: |
  バージョン: 2.0
  計画担当: @planner, @plan-converter
  状態管理: @state-manager
---
# Flow: 統合プロジェクト初期化コマンド (flow-init)

このコマンドは、プロジェクトのTDDフローを初期化する**統合コマンド**です。**仕様書**からのタスク生成、または**簡単なアイデア**からのタスク生成に対応します。実行時に既存のフローがあれば、**自動で上書き**して常に新しい状態で開始します。

フロー関連のファイルはすべて `.claude/.flow/` ディレクトリに保存されます。

## 使用例

```bash

# 仕様書モード: docs/spec.md を基にプロジェクトを初期化

/flow-init docs/spec.md

# アイデアモード: 簡単な指示からプロジェクトを初期化

/flow-init "ユーザー認証用のCRUD APIを作成する"
```

---

## 実行フロー

### ステップ1: モードの判断

引数が実在するファイルパスであれば**仕様書モード**として、そうでなければ**アイデアモード**として動作を決定します。

### ステップ2: フローディレクトリの準備 (by @state-manager)

**進捗報告:**
「プロジェクトの初期化を開始します。既存の状態をクリーンアップしています...」

`@state-manager`を呼び出し、`.claude/.flow` ディレクトリを作成します。もしディレクトリが既に存在する場合、中身を**完全にクリア**して上書き準備をします。

### ステップ3: タスクリストの生成 (モード別)

#### 🟩 仕様書モードの場合... (by @plan-converter)

**進捗報告:**
「仕様書を分析し、タスクリストに変換します...」

`@plan-converter`を呼び出し、指定された仕様書を**忠実に**解析させ、`.claude/.flow/tasks.md`を生成します。

#### 🟩 アイデアモードの場合... (by @planner)

**進捗報告:**
「アイデアを分析し、開発計画を策定します...」

`@planner`を呼び出し、与えられたアイデアから**創造的に**開発計画を策定させ、`.claude/.flow/tasks.md`を生成します。

### ステップ4: 詳細な状態ファイルの初期化 (by @state-manager)

**進捗報告:**
「プロジェクトの詳細な状態を初期化します...」

`@state-manager`を再度呼び出し、生成された`tasks.md`を基に、詳細な状態ファイル`.claude/.flow/state.json`を作成させます。

`state.json`には以下の情報が構造化されて記述されます。

- `phase`: "red" (TDDの初期フェーズ)
- `current_task`: 現在進行中のタスク（リストの最初のタスク）
- `completed_tasks`: 完了したタスクのリスト（初期状態では空）
- `pending_tasks`: これから行うタスクのリスト（2番目以降のタスク）

### ステップ5: 最終報告

初期化が完了したことを報告します。
最後に`@state-manager`を呼び出し、生成されたばかりの**詳細なプロジェクト状態**をユーザーに表示します。
