---
description: "[設計書レビュー] 設計書の品質を対話的にレビュー・検証"
allowed-tools: Read, Glob, Grep
argument_hint: "<feature-name>"
---

# 設計書品質レビュー

機能名: **$1** の設計書を対話的にレビューします。

## コンテキスト読み込み

### 前提条件の検証

- 設計書が存在すること: `.claude/specs/$1/design.md`
- 存在しない場合は停止し、メッセージを表示: "`/spec-design $1`を先に実行して設計書を生成してください"

### レビューコンテキスト

以下のファイルを読み込みます：

- 仕様メタデータ: `.claude/specs/$1/spec.json`
- 要件定義書: `.claude/specs/$1/requirements.md`（存在する場合）
- 設計書: `.claude/specs/$1/design.md`
- コアSteeringドキュメント:
  - アーキテクチャ: `.claude/steering/structure.md`
  - 技術スタック: `.claude/steering/tech.md`
  - プロダクト文脈: `.claude/steering/product.md`
- カスタムSteering: `.claude/steering/`ディレクトリ内のすべての`.md`ファイル

## タスク: 対話的な設計品質レビュー

### レビュー手法

**焦点**: 重大な問題のみ - 最も重要な懸念事項を最大3つに限定
**形式**: 即座のフィードバックと改善提案を含む対話的なダイアログ
**成果物**: 明確な根拠を持つGO/NO-GO決定

### コアレビュー基準

#### 1. 既存アーキテクチャとの整合性（重要）

**評価ポイント**:
- 既存システムの境界とレイヤーとの統合
- 確立されたアーキテクチャパターンとの一貫性
- 適切な依存関係の方向と結合管理
- 現在のモジュール構成と責任との整合性

**レビュー質問**:
- この設計は既存のアーキテクチャ境界を尊重しているか？
- 新しいコンポーネントは既存システムと適切に統合されているか？
- 設計は確立されたパターンと規約に従っているか？

#### 2. 設計の一貫性と基準

**評価ポイント**:
- プロジェクトの命名規則とコード基準への準拠
- 一貫したエラーハンドリングとロギング戦略
- 設定と依存関係管理への統一的なアプローチ
- 確立されたデータモデリングパターンとの整合性

**レビュー質問**:
- 設計は既存のコード基準と一貫しているか？
- エラーハンドリングと設定アプローチは統一されているか？
- 命名と構造はプロジェクト規約に従っているか？

#### 3. 拡張性と保守性

**評価ポイント**:
- 将来の要件変更に対する設計の柔軟性
- 関心の明確な分離と単一責任原則
- テスト可能性とデバッグの考慮事項
- ドキュメントとコードの明瞭性要件

**レビュー質問**:
- この設計は将来の変更にどの程度対応できるか？
- 責任は明確に分離されテスト可能か？
- 設計の複雑さは要件に対して適切か？

#### 4. 型安全性とインターフェース設計

**評価ポイント**（型付き言語のプロジェクトの場合）:
- 適切な型定義とインターフェース契約
- `any`型や安全でないパターンの回避
- 明確なAPI境界とデータ構造定義
- 入力検証とエラーハンドリングのカバレッジ

**レビュー質問**:
- 型は適切に定義され、インターフェースは明確か？
- API設計は堅牢で明確に定義されているか？
- エッジケースとエラー条件は適切に処理されているか？

### 対話的レビュープロセス

#### ステップ1: 設計分析

すべてのレビュー基準に対して設計書を徹底的に分析し、以下に影響を与える可能性のある最も重大な問題を特定します：

- システム統合と互換性
- 長期的な保守性
- 実装の複雑さとリスク
- 要件の充足精度

#### ステップ2: 重大な問題の特定

**最大3つの最も重要な懸念事項に限定**。各重大な問題について：

**問題フォーマット**:

```text
🔴 **重大な問題 [1-3]**: [簡潔なタイトル]
**懸念事項**: [具体的な問題の説明]
**影響**: [なぜこれがプロジェクトにとって重要か]
**提案**: [具体的な改善推奨事項]
```

#### ステップ3: 設計の強みの認識

バランスの取れたフィードバックを維持するため、設計の1〜2つの強い側面を認めます。

#### ステップ4: GO/NO-GO決定

**GO基準**:
- 重大なアーキテクチャのミスアライメントがない
- 要件が適切に対処されている
- 実装パスが明確で合理的
- リスクが受け入れ可能で管理可能

**NO-GO基準**:
- 基本的なアーキテクチャの衝突がある
- 重要な要件が対処されていない
- 実装アプローチに高い失敗リスクがある
- 設計の複雑さが要件に対して不釣り合い

### 出力フォーマット

spec.jsonで指定された言語（`.claude/specs/$1/spec.json`の"language"フィールドを確認）でレビューを生成します：

#### 設計レビューサマリー

設計の全体的な品質と準備状況の簡潔な概要。

#### 重大な問題（最大3つ）

特定された各問題について：

- **問題**: 明確な問題の説明
- **影響**: なぜ重要か
- **推奨事項**: 具体的な改善提案

#### 設計の強み

強調する価値のある1〜2つの肯定的な側面。

#### 最終評価

**決定**: GO / NO-GO
**根拠**: 決定の明確な理由
**次のステップ**: 次に何をすべきか

#### 対話的ディスカッション

以下について対話を行います：

- 特定された問題に対する設計者の視点
- 代替アプローチやトレードオフ
- 設計決定の明確化
- 必要な変更についての合意（ある場合）

## レビューガイドライン

1. **重要な焦点**: 成功に大きく影響する問題のみをフラグ化
2. **建設的なトーン**: 批判だけでなく解決策を提供
3. **対話的アプローチ**: 一方的な評価ではなく対話に従事
4. **バランスの取れた評価**: 強みと弱みの両方を認識
5. **明確な決定**: 明確なGO/NO-GO推奨を行う
6. **実行可能なフィードバック**: すべての提案が実装可能であることを確認

## 実行手順

1. **すべてのコンテキストドキュメントを読み込む** - プロジェクト全体の範囲を理解
2. **設計を徹底的に分析** - すべての基準に対してレビュー
3. **重大な問題のみを特定** - 最も重要な問題に焦点
4. **対話的に関与** - ユーザーと調査結果について議論
5. **明確な決定を行う** - 明確なGO/NO-GOを提供
6. **次のステップを案内** - 進むための明確な方向性

**注意**: これは品質保証であり、完璧を求めるものではありません。目標は、設計が許容可能なリスクで実装に進むのに十分堅固であることを確認することです。

---

## 次のフェーズ: タスク生成

設計検証後：

**設計が検証を通過した場合（GO決定）**:
`/flow-init $1`を実行して実装タスクを生成し、TDDフローを開始

**設計に問題がある場合（NO-GO決定）**:
`/spec-design $1`を再実行して設計書を修正

## 使用例

```bash
# 設計書の品質レビュー
/validate-design user-authentication

# レビュー後、GOの場合
/flow-init user-authentication
```
