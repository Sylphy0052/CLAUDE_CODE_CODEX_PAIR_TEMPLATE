---
description: "[プロジェクト知識管理] product.md, tech.md, structure.mdを作成・更新"
allowed-tools: Bash, Read, Write, Edit, Glob, Grep
---

# プロジェクト知識管理

プロジェクト全体のコンテキストを`.claude/steering/`配下に保存します。既存ファイルがある場合はユーザーカスタマイズを保持しつつ、事実情報のみを更新します。

## Task

### 1. ディレクトリ作成

`.claude/steering/`ディレクトリを作成します（既存の場合はスキップ）。

```bash
mkdir -p .claude/steering
```

### 2. プロジェクトコンテキストの収集

#### ディレクトリ構造の取得

Bashツールで以下を実行してディレクトリ構造を取得：

```bash
ls -R | head -100
```

または

```bash
find . -maxdepth 2 -type d | grep -v node_modules | grep -v .git
```

#### 主要ファイルの読み込み

以下のファイルが存在する場合、Readツールで読み込む：

- `README.md`: プロジェクト概要
- `pyproject.toml` または `package.json`: 依存関係と設定
- `requirements.txt`: Python依存関係（存在する場合）
- `.python-version` または `.nvmrc`: 言語バージョン（存在する場合）

### 3. ファイル生成または更新

#### product.md（プロダクト概要）

**新規作成の場合**、以下の内容を含める：

- **プロジェクト概要**: プロジェクトの目的と説明
- **主要機能**: 提供する機能のリスト
- **ターゲットユーザー**: 想定されるユーザー層
- **技術的な特徴**: プロジェクトの技術的な強みや特徴

**既存ファイルの更新の場合**、以下のみ更新：

- 新しく追加された機能
- 削除された機能（[DEPRECATED]としてマーク）
- ターゲットユーザーの変更
- ユーザーのカスタマイズ部分は保持

#### tech.md（技術スタック）

**新規作成の場合**、以下の内容を含める：

- **言語とバージョン**: 例: Python 3.11, Node.js 18
- **フレームワーク**: 例: FastAPI, Next.js
- **主要ライブラリ**: 依存関係から抽出
- **開発環境セットアップ**: 環境構築手順
- **よく使うコマンド**: 開発、テスト、ビルドコマンド
- **環境変数**: 必要な環境変数（機密情報は除く）

**既存ファイルの更新の場合**、以下のみ更新：

- 新しい依存関係
- 削除された依存関係（[REMOVED]としてマーク）
- バージョンアップグレード
- 新しいコマンド
- ユーザーのカスタマイズ部分は保持

#### structure.md（ディレクトリ構造）

**新規作成の場合**、以下の内容を含める：

- **ディレクトリ構造**: `tree -L 2`相当の構造図
- **主要ディレクトリの説明**: 各ディレクトリの役割
- **ファイル命名規則**: ファイル名のパターン
- **コード組織パターン**: モジュール構成やアーキテクチャパターン

**既存ファイルの更新の場合**、以下のみ更新：

- 新しいディレクトリ
- 削除されたディレクトリ（[REMOVED]としてマーク）
- ディレクトリ構造の大幅な変更
- ユーザーのカスタマイズ部分は保持

### 4. 更新戦略

#### 既存ファイルの保護

既存ファイルを読み込み、以下を保持：

- ユーザーが追加したカスタムセクション
- ユーザーが追加した例やコメント
- 既存のフォーマットスタイル
- 標準テンプレート外のすべての内容

#### 事実情報の更新

以下のみを更新：

- 依存関係（バージョン、新規追加、削除）
- ディレクトリ構造（新規、削除、移動）
- コマンド（新規、変更、削除）
- 技術スタック（言語バージョン、フレームワーク）

#### 更新のマーク

削除された項目には以下のマークを付ける：

- `[DEPRECATED]`: 非推奨だが互換性のために残存
- `[REMOVED]`: 完全に削除された機能

## 出力

```
✅ プロジェクト知識を更新

📄 .claude/steering/product.md - [新規作成 | 更新]
📄 .claude/steering/tech.md - [新規作成 | 更新]
📄 .claude/steering/structure.md - [新規作成 | 更新]
```

## 注意事項

### セキュリティ

- **機密情報は含めない**: APIキー、パスワード、データベース認証情報、個人情報は記載しない
- **コミット前にレビュー**: 常にsteeringファイルの内容をレビューしてからバージョン管理に含める

### 品質ガイドライン

- **単一ドメインに焦点**: 各steeringファイルは1つの特定領域をカバー
- **明確で具体的な内容**: 抽象的な原則ではなく、具体例と根拠を提供
- **定期的なメンテナンス**: プロジェクトの大きな変更後にsteeringファイルをレビュー・更新
- **実行可能なガイダンス**: 具体的で実装可能なガイドラインを記述

### 更新哲学

- **追加優先**: 置き換えではなく、新しい情報を追加
- **非推奨のマーク**: 削除ではなく、取り消し線や[DEPRECATED]タグを使用
- **重要な変更には日付**: 大きな変更にはタイムスタンプを追加
- **変更理由の説明**: 更新の理由を簡潔に記載

目標は、ユーザーのカスタマイズを尊重しながら、常に最新の状態を保つ生きたドキュメントを維持することです。
