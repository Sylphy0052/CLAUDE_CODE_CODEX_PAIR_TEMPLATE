---
description: |
  [自動Gitコミット] 現在の変更をAIが完全に自動で分析し、日本語のConventional Commitメッセージを生成してコミットを実行します。
argument_hint: "[コミットメッセージのヒント (任意)]"
notes: |
  バージョン: 3.0
  担当: 内部AI処理 (git操作不要)
---
# 自動Gitコミットコマンド (ccommit)

## 概要

`/ccommit` コマンドは、現在の作業ディレクトリ内のファイル変更を自動で検出し、AIがその変更内容を理解して**Conventional Commits規約**に沿った最適なコミットメッセージを生成・記録するためのコマンドです。

Gitコマンドの直接実行（`git add`, `git commit`など）は行わず、**差分内容と生成されたメッセージをファイルに保存**する形で記録します。

## 使用例

```bash

# 変更内容を自動解析してコミット情報を生成

/ccommit

# AIにヒントを与えて、より意図に沿ったコミットメッセージを生成

/ccommit "ユーザー認証のリファクタリング"
```

---

## 実行フロー

### ステップ1: 差分の検出

- 作業ディレクトリ内の変更を解析します。
- 比較対象として、直近の保存状態（例: `.claude/.flow/state.json`や`.claude/.last_snapshot/`）を参照します。
- 新規作成・変更・削除の一覧を抽出し、内容を要約します。

**進捗報告:**
「現在の変更をスキャン中です...」

---

### ステップ2: AIによるコミットメッセージ生成

1. 変更要約を入力としてAIに渡します。
2. AIは変更意図を推測し、以下の形式でメッセージを生成します。

```
<type>(<scope>): <概要>
<詳細説明>
```

生成ルール:

- **type**: feat / fix / refactor / docs / test など
- **scope**: 変更対象モジュールやファイル名
- **概要**: 50文字以内の短い説明
- **詳細説明**（任意）: 変更理由や改善内容を自然文で

**進捗報告:**
「変更内容を解析し、最適なConventional Commitメッセージを生成しています...」

---

### ステップ3: コミット内容の保存

生成されたコミット情報は、`commits/` ディレクトリ内に自動保存されます。

- 保存先: `.claude/commits/YYYYMMDD_HHMMSS.md`
- ファイル内容例:

```

# 自動生成コミット記録

日時: 2025-10-03 15:45:22
タイプ: fix
スコープ: api
概要: ユーザー取得時のバリデーション不具合を修正
詳細:

- 無効なリクエスト時に例外が正しく発生しない問題を修正
- テストケースを追加
```

この記録は、Git履歴の代替として利用できるほか、他のAIコマンド（`flow-status`など）が進捗を追跡するためにも使用されます。

---

### ステップ4: 実行結果の報告

最終的に、生成したコミットメッセージと保存先パスをユーザーに報告します。

**完了報告例:**

```
✅ 自動コミット記録を保存しました。
Path: .claude/commits/20251003_154522.md
Message: fix(api): ユーザー取得時のバリデーション不具合を修正
```

---

## 備考

- 実際のGit操作は行いません（安全設計）。
- 変更内容の保存フォーマットは拡張可能で、外部Git連携モジュールとの接続を想定しています。
- `flow` 系コマンドの完了後に実行すると、状態トラッキングを一貫して自動化できます。
