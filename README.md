# AI駆動開発ワークフロー 総合ガイド (v3.1)

このドキュメントは、本プロジェクトで定義されたカスタムAIワークフローの全体像、各コンポーネントの仕様、そして具体的な使用方法について解説する総合的なマニュアルです。

## 1. 概要と設計思想

本ワークフローは、**AIエージェントを専門家チームとして活用**し、アイデア創出からシステム全体の設計、TDDによる実装、そして規律あるバージョン管理まで、開発ライフサイクル全体を一気通貫でサポートすることを目的としています。

中核となるのは、**トップダウンの設計思想**です。まずシステム全体の骨格を定義し、そこから個別の機能へと詳細化していくことで、手戻りの少ない効率的な開発を実現します。

## 2. ディレクトリ構成

プロジェクトは以下のディレクトリ構造を基本とします。

```plaintext
my-ai-project/
├── .claude/
│   ├── agents/
│   │   └── ... (各種エージェント定義ファイル)
│   └── commands/
│       └── ... (各種カスタムコマンド定義ファイル)
│
├── .flow/
│   ├── tasks.md
│   └── state.json
│
├── docs/
│   ├── SYSTEM_OVERVIEW.md
│   ├── features/
│   │   └── auth.md
│   ├── system-overview-template.md  <-- テンプレート
│   └── spec-template.md             <-- テンプレート
│
├── CLAUDE.md
└── AGENTS.md
```

## 3. 主要な設定ファイル

- **`CLAUDE.md`**: プロジェクト全体のAI（Claude Code）に対する**基本設定ファイル（憲法）**。
- **`AGENTS.md`**: **Codex CLI専用の指示書**。
- **`docs/system-overview-template.md`**: `/design-system`が使用する、**システム設計書の雛形**。
- **`docs/spec-template.md`**: `/spec-writer`や`/spec-interview`が使用する、**機能仕様書の雛形**。

## 4. 推奨ワークフロー：トップダウン開発

ゼロからシステムを開発する場合、以下の手順を推奨します。

### ステップ1: システム全体の設計 🏛️

まず、AIアーキテクトにシステム全体の骨格を設計させます。

```bash
/design-system "飼い主向けのペット写真共有SNS"
```

これにより、`docs/SYSTEM_OVERVIEW.md`と、実装すべき主要機能のリストが生成されます。

### ステップ2: 各機能の仕様を詳細化 📝

次に、ステップ1で洗い出された各機能について、対話形式で詳細な仕様書を作成します。

```bash
/spec-interview "ユーザー登録・ログイン機能"
```

このコマンドを機能の数だけ実行し、`docs/features/`配下に機能ごとの仕様書を作成していきます。

### ステップ3: 開発計画の立案 🗺️

詳細な仕様書が完成したら、それを基に実行可能なタスクリストを生成します。

```bash
/init-from-spec
```

これにより、`docs/`配下の仕様書が解析され、`.flow/tasks.md`が自動生成されます。

### ステップ4: TDDサイクルによる実装 ⚙️

開発計画が完成したら、TDDサイクルを開始します。

```bash

# 現在のタスクを完了まで自動実行

/flow-run
```

### ステップ5: バージョン管理 ✅

機能の実装が完了したら、規約に則ってコミットします。

```bash
/ccommit "ユーザー登録機能の実装を完了"
```

---

## 5. カスタムコマンド リファレンス

| コマンド | 説明 |
| :--- | :--- |
| **`/design-system`** | **[システム設計]** `docs/system-overview-template.md`を基に、システム全体の基本設計と機能リストをゼロから作成します。**（推奨される最初のコマンド）** |
| **`/spec-interview`** | **[対話型 仕様書作成]** `docs/spec-template.md`を基に、1問1答形式で単一機能の詳細な仕様書を段階的に作成・更新します。 |
| **`/spec-writer`** | **[仕様書作成]** `docs/spec-template.md`を基に、一度の指示で単一機能の仕様書の草案を作成します。 |
| **`/init-from-spec`** | **[仕様書から初期化]** `docs/`配下の仕様書を解析し、TDDワークフローを開始するためのタスクリストを生成します。 |
| **`/flow-init`** | **[アイデアから初期化]** 簡単な指示から、AIが創造的にタスクリストを直接生成します。（小規模なタスク向け） |
| **`/flow-status`** | **[進捗確認]** TDDワークフローの現在の進捗状況を表示します。 |
| **`/flow-next`** | **[TDDサイクル実行]** TDDサイクルを1ステップ進めます。 |
| **`/flow-run`** | **[TDDサイクル連続実行]** 現在のタスクが完了するまでTDDサイクルを自動で連続実行します。 |
| **`/flow-reset`** | **[リセット]** TDDワークフローの進捗を安全にリセットします。 |
| **`/ccommit`** | **[Gitコミット]** 対話形式で、日本語Conventional Commitメッセージを生成しコミットします。 |
| **`/impl-codex`** | **[単発実装]** Codexに実装を依頼し、その結果をClaudeがレビューします。 |
| **`/review-codex`** | **[単発レビュー]** 1つのコードをCodexとClaudeの両方がレビューし、結果を統合します。 |

---

## 6. サブエージェント（AIチーム）リファレンス

| エージェント | 役割 |
| :--- | :--- |
| **`@system-architect`** | **システムアーキテクト**。システム全体の骨格を設計し、主要機能を洗い出す。 |
| **`@spec-interviewer`** | **仕様書インタビュアー**。ユーザーと対話し、単一機能の仕様書を段階的に完成させる。 |
| **`@spec-writer`** | **仕様書ライター**。一度の指示で、単一機能の仕様書の草案を執筆する。 |
| **`@plan-converter`** | **計画コンバーター**。完成した仕様書をタスクリストに忠実に変換する。 |
| **`@planner`** | **創造的プランナー**。簡単な指示から、タスクをゼロから考案する。 |
| **`@state-manager`** | **システム管理者**。`flow`ワークフローの状態を安全に管理する。 |
| **`@test-writer`** | **QAエンジニア**。TDDのRedフェーズで、失敗するテストコードを作成する。 |
| **`@implementer`** / **`@codex-implementer`** | **開発者**。テストをパスさせるためのコードを実装・改善する。（Claude/Codex） |
| **`@code-reviewer`** / **`@codex-reviewer`** | **レビュアー**。設計原則や実践的な観点からコードをレビューする。（Claude/Codex） |
| **`@git-committer`** | **Git専門家**。Conventional Commits規約に基づき、コミットメッセージを生成する。 |
